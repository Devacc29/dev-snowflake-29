
USE ROLE ACCOUNTADMIN;
USE WAREHOUSE DEF_WS_WH;


GRANT USAGE ON SCHEMA MANAGE_DB.INTEGRATIONS TO ROLE SYSADMIN;

GRANT READ ON GIT REPOSITORY MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO TO ROLE SYSADMIN;

GRANT OWNERSHIP ON GIT REPOSITORY MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO TO SYSADMIN REVOKE CURRENT GRANTS;


GRANT OWNERSHIP ON GIT REPOSITORY MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO TO ROLE SYSADMIN;


USE ROLE SYSADMIN;

ls @MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO/branches/main;

ALTER GIT REPOSITORY MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO FETCH;

ls @MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO/branches/main;

EXECUTE IMMEDIATE FROM  @MANAGE_DB.INTEGRATIONS.GIT_SNOW_REPO/branches/main/WAREHOUSES/TEST-WH;