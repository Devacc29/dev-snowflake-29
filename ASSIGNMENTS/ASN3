USE ROLE SYSADMIN;
USE WAREHOUSE DEF_WS_WH;

USE DATABASE EXERCISE_DB;

SELECT * FROM EXERCISE_DB.PUBLIC.CUSTOMERS;

-- Clear the table data without deleting the table 

TRUNCATE TABLE EXERCISE_DB.PUBLIC.CUSTOMERS;

DESC TABLE EXERCISE_DB.PUBLIC.CUSTOMERS;

CREATE OR REPLACE STAGE EXERCISE_DB.PUBLIC.AWS_STAGE
    URL='s3://snowflake-assignments-mc/loadingdata/';

LIST @AWS_STAGE;


-- IF THE STAGE FILES CONTAINS SAME DETAILS LIKE TABLE IT WILL LOAD ALL FILES DATA. you dont have to mention specific file name or pattern.

COPY INTO EXERCISE_DB.PUBLIC.CUSTOMERS
    FROM @EXERCISE_DB.PUBLIC.AWS_STAGE
    FILE_FORMAT=(type='csv' field_delimiter=';' skip_header=1);
    

SELECT * FROM EXERCISE_DB.PUBLIC.CUSTOMERS;

